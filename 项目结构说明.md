# 闽台方言大模型系统 - 项目结构说明

## 📋 项目概述

闽台方言大模型系统是一个基于人工智能的闽台方言语音处理平台，支持语音识别、文本转语音、语音翻译、智能对话和音色克隆等功能。

## 🏗️ 项目架构

```
MintaiDialect/
├── 📁 backend/                    # 后端服务
├── 📁 frontend/                   # 前端界面
├── 📁 scripts/                    # 部署脚本
├── 📁 models/                     # AI模型文件
├── 📁 test/                       # 测试文件
├── 📄 docker-compose.yml         # Docker编排配置
├── 📄 mintai.yml                 # Conda环境配置
├── 📄 openapi.yaml               # API接口文档
└── 📄 README.md                  # 项目说明文档
```

## 🔧 核心组件

### 1. 后端服务 (backend/)

**技术栈**: FastAPI + Python 3.10 + PyTorch + SQLite

```
backend/
├── 📁 app/                        # 应用核心代码
│   ├── 📄 main.py                # FastAPI应用入口
│   ├── 📁 core/                  # 核心配置模块
│   ├── 📁 models/                # 数据模型定义
│   ├── 📁 routers/               # API路由模块
│   └── 📁 services/               # 业务逻辑服务
├── 📁 uploads/                    # 文件上传目录
├── 📁 logs/                       # 日志文件目录
├── 📁 models/                     # 本地模型文件
├── 📁 cache/                      # 缓存目录
├── 📁 data/                       # 数据文件目录
├── 📄 requirements.txt           # Python依赖包
├── 📄 Dockerfile                 # Docker构建文件
└── 📄 dialect_ai.db              # SQLite数据库
```

**主要功能模块**:
- **ASR服务**: 语音识别 (端口9010)
- **TTS服务**: 文本转语音 (端口9030) 
- **LLM服务**: 大语言模型 (端口9020)
- **API接口**: RESTful API服务 (端口8000)

**端口规则**:
- **标准服务（多语言模型）**: ASR=9010, LLM=9020, TTS=9030
- **方言ASR服务**: 9011, 9012, ... (x从1开始递增)
- **方言TTS服务**: 9031, 9032, ... (x从1开始递增)
- **注意**: LLM只有标准服务（9020），无方言服务

### 2. 前端界面 (frontend/)

**技术栈**: React 18 + TypeScript + Vite + Ant Design

```
frontend/
├── 📁 src/                        # 源代码目录
│   ├── 📄 App.tsx                # 主应用组件
│   ├── 📄 main.tsx               # 应用入口
│   ├── 📁 pages/                 # 页面组件
│   ├── 📁 components/            # 公共组件
│   ├── 📁 services/              # API服务
│   ├── 📁 contexts/               # React上下文
│   ├── 📁 types/                 # TypeScript类型定义
│   └── 📁 assets/                # 静态资源
├── 📄 package.json               # 项目依赖配置
├── 📄 vite.config.ts             # Vite构建配置
├── 📄 Dockerfile                 # Docker构建文件
└── 📄 nginx.conf                 # Nginx配置
```

**主要功能页面**:
- 语音文本互转界面
- 语音翻译界面  
- 智能对话界面 (数字嘉庚)
- 音色克隆界面

### 3. 部署脚本 (scripts/)

```
scripts/
├── 📁 single/                    # 单服务启动脚本
│   ├── 📄 start-asr.sh           # ASR服务启动
│   ├── 📄 start-tts.sh           # TTS服务启动
│   ├── 📄 start-llm.sh           # LLM服务启动
│   ├── 📄 start-backend.sh       # 后端服务启动
│   ├── 📄 start-frontend.sh      # 前端服务启动
│   └── 📄 install-deps.sh        # 依赖安装脚本
├── 📁 linux/                     # Linux部署脚本
├── 📄 start.bat                  # Windows启动脚本
└── 📄 install.bat                 # Windows安装脚本
```

### 4. AI模型 (models/)

存储各种AI模型文件，包括:
- 语音识别模型 (ASR)
- 文本转语音模型 (TTS)
- 大语言模型 (LLM)
- 音色克隆模型

## 🚀 服务架构

### 微服务架构

系统采用微服务架构，各服务独立部署:

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  前端服务    │    │  后端API    │    │  数据库     │
│  (端口3000)  │◄──►│  (端口8000)  │◄──►│  (SQLite)   │
└─────────────┘    └─────────────┘    └─────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  ASR服务    │    │  TTS服务    │    │  LLM服务    │
│  (端口9010)  │    │  (端口9030)  │    │  (端口9020)  │
└─────────────┘    └─────────────┘    └─────────────┘
```

### 环境配置

**开发环境**:
- 前端: http://localhost:5173
- 后端: http://localhost:8000
- API文档: http://localhost:8000/docs

**生产环境**:
- 前端: http://localhost:3000
- 后端: http://localhost:8000

## 🔧 技术特性

### 1. 语音处理能力
- **高精度方言识别**: 支持闽南话、客家话、台湾话
- **自然语音合成**: 基于VITS模型的TTS服务
- **实时语音翻译**: 方言与普通话双向翻译
- **音色克隆**: 文本驱动和音频驱动两种模式

### 2. 智能对话系统
- **数字嘉庚模块**: 语音输入→ASR→LLM→TTS→音频输出
- **多轮对话**: 支持上下文理解和记忆
- **字幕同步**: 智能字幕时间轴拟合
- **缓存优化**: TTS音频缓存机制

### 3. 开发友好特性
- **热重载**: 开发时自动重启和更新
- **类型安全**: TypeScript + Pydantic
- **API文档**: 自动生成的Swagger文档
- **Docker支持**: 一键部署和扩展

## 📦 部署方式

### 1. 开发环境
```bash
# 一键启动所有服务
./start-all.sh

# 或分步启动
bash scripts/single/start-asr.sh      # ASR服务
bash scripts/single/start-tts.sh      # TTS服务  
bash scripts/single/start-llm.sh      # LLM服务
bash scripts/single/start-backend.sh  # 后端服务
bash scripts/single/start-frontend.sh # 前端服务
```

### 2. 生产环境
```bash
# Docker部署
docker-compose up -d --build

# 传统部署
cd backend && uvicorn app.main:app --host 0.0.0.0 --port 8000
cd frontend && npm run build
```

## 🔍 关键文件说明

| 文件/目录 | 功能说明 |
|----------|---------|
| `backend/app/main.py` | FastAPI应用主入口 |
| `frontend/src/App.tsx` | React应用主组件 |
| `docker-compose.yml` | Docker服务编排配置 |
| `mintai.yml` | Conda环境依赖配置 |
| `openapi.yaml` | API接口规范文档 |
| `scripts/single/` | 各微服务独立启动脚本 |
| `backend/uploads/` | 用户上传文件存储 |
| `backend/logs/` | 应用日志文件 |
| `backend/models/` | 本地AI模型文件 |

## 🎯 核心功能流程

### 语音识别流程
```
音频文件 → ASR服务 → 文本结果 → 后端API → 前端展示
```

### 文本转语音流程  
```
文本输入 → 后端API → TTS服务 → 音频文件 → 前端播放
```

### 智能对话流程
```
语音输入 → ASR → LLM处理 → TTS → 音频输出 + 字幕同步
```

## 📝 开发说明

- **代码规范**: 使用TypeScript和Python类型注解
- **错误处理**: 统一的异常处理和日志记录
- **性能优化**: TTS缓存、音频压缩、懒加载
- **安全考虑**: 文件上传限制、CORS配置、输入验证

---

*本文档提供了闽台方言大模型系统的完整项目结构说明，帮助开发者快速理解项目架构和功能模块。*
